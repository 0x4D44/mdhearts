Hard Performance Findings and Next Steps — 2025-10-22

Summary
- Implemented H1 (leverage tiers, budgets, telemetry) and H2 (planner nudges + adaptive continuation scaling), all behind env knobs. Defaults unchanged; tests green.
- Ran mixed-seat evaluations (deterministic) across seats and permutations. With conservative to moderate knobs, average penalties per hand for the measured seat did not shift materially over 60–200 seed windows.
- Conclusion: To create a clear, measurable Hard > Normal gap (+1–2 pts/hand), we need either (a) stronger default continuation signals + wider continuation coverage under tiering, or (b) targeted base-score nudges gated by difficulty=Hard, and/or (c) selective deepening where it matters (Wide tier), while preserving CI stability via env gates and goldens.

What we built
- H1 (env-gated):
  - Leverage tiers (Narrow/Normal/Wide) with per-tier PhaseB-K, next-probe M, and AB margin; extended Stats (phases, tier, utilization, limits). Explain path remains deterministic.
- H2 (env-gated):
  - Planner nudges (Normal) for leader-feed and self-capture near 100 (tiny, guarded).
  - Hard continuation scaling per-penalty (feed/self) with cap, surfaced in verbose parts.
- CLI/docs updated; journal kept current.

Evaluation runs (artifacts)
- West 200 seeds, 3 permutations: designs/tuning/eval_summary_2025-10-22_h2_expanded_west.md
- All seats 120 seeds, 3 permutations: designs/tuning/eval_summary_2025-10-22_h2_tiers_allseats.md
- Smaller baselines and boosted trial: designs/tuning/*_60_*.csv, *_1120_100_*.csv

Findings
- With tiering OFF/ON and conservative H2 knobs, averages remained equal for sampled ranges. Even with stronger (but still bounded) knobs, the effect was not visible in these aggregates.
- Root causes:
  1) Continuation signals are tiny and applied only to top-K candidates; many decisions remain base-score dominated.
  2) Early cutoff and tight next-probe limits reduce opportunities for continuation to influence ranks.
  3) Mixed-seat evaluation (NNHH/NHNH/HNNH) can mask small single-seat improvements.

Recommendations (prioritized)
1) Hard-only default promotions (small, incremental):
   - Enable tiers by default for Hard only; keep Normal unchanged.
   - Modestly increase continuation weights (feed/self) and set a small but non-zero continuation cap.
   - Slightly widen PhaseB-K and next-probe M in Wide tier (e.g., 8/3), keep Normal tier at current defaults.
   - Acceptance: No CI golden regressions; deterministic goldens show stable flips where intended.

2) Planner-level Hard gating (base-score nudges for difficulty=Hard):
   - Introduce minimal Hard-only nudges inline (base_score path), keeping Normal logic intact.
   - Examples: slightly larger leader-feed per-penalty factor when penalties_on_table>0 and winner=leader; add small extra self-capture penalty when our score ≥ 85.
   - Gate by difficulty (Hard) rather than env to achieve a default gap; keep small to protect stability.

3) Selective deepening in Wide tier (choose-only):
   - Allow limited third-opponent branching and/or a slightly wider next-probe under strict budget in Wide tier.
   - Keep explain path unchanged; maintain determinism and parity tests.

4) Expand targeted goldens and tools:
   - Add constructed mid-trick near-tie goldens that demonstrate continuation deciding (feeding leader vs self-capture), guarded by deterministic mode.
   - Add a few tier-induced flips (Wide tier scenarios) as goldens.
   - Keep mixed-seat harness and CSV summaries in docs for tuning.

Rollout plan
- Phase A (Small defaults for Hard):
  - Turn on tiers for Hard; set per-tier defaults: Narrow(4/1/100), Normal(6/2/150), Wide(8/3/200).
  - Weights: feed/self per-penalty +10–20% over current; set cont_cap≈250.
  - Verify tests/goldens; add 1–2 constructed goldens proving improved choices.

- Phase B (Hard-only base-score tiny nudges):
  - Add small Hard-gated leader-feed/self-capture increments directly in base_score.
  - Verify no regressions; lock a golden.

- Phase C (Wide tier deepening):
  - Enable minimal third-opponent branching/time-budgeted next-probe widening in choose-only when tier=Wide.
  - Keep explain deterministic; expand parity tests.

Exit criteria
- Mixed-seat evaluations across seats/permutations show ≥0.5–1.0 pt advantage for Hard over Normal (averaged over ≥300 seeds/seat), sustained after stabilizing goldens and docs.

Appendix: Env knobs
- Tiering: MDH_HARD_TIERS_ENABLE=1; thresholds MDH_HARD_LEVERAGE_THRESH_*.
- Continuation: MDH_HARD_CONT_* (feed/self weights, scaling, caps, boost-gap/factor).
- Planner nudges: MDH_HARD_PLANNER_*.
