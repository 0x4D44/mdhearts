# Stage 5 — Follow‑Through Checklist (Hard++)

Context
- Stage 5 plan is in place and most infra/tools are done; remaining work is focused tests, tiny polish, and guardrails.
- Defaults are conservative; env‑gated features keep goldens stable.

Immediate priorities (next work block)
- Add constructed endgame golden using `MDH_W_ENDGAME_FEED_CAP` to assert capped leader‑feed behavior.
- Add Hard moon transition smoke: multi‑trick sequence (Considering → Committed) with continuation relief alignment.

Short‑term tasks
- Probe/pruning polish (env‑gated): verify `next_trick_probe` pruning remains monotonic and budget‑honoring; add a stress test with tight caps.
- Alpha–beta skip safety: ensure choose() AB margin reduces scans without affecting explain output or top choice in clear cases.
- Expand disagreements/flip goldens modestly from scanned seeds (deterministic mode), keeping existing suites stable.

Perf & determinism
- Run bench‑check across seats with deterministic caps; capture avg/p95 and add results to journal.
- Keep popups off by default (`MDH_CLI_POPUPS` unset); all tuning/explain outputs to console/CSV/JSON.

Tuning pass guidance
- Use `--compare-batch` with `--only-disagree` and deterministic flags; inspect verbose continuation parts.
- Nudge env‑only continuation weights if they clearly improve feed‑leader vs self‑protect balance; promote to defaults only if goldens stay stable.

Acceptance
- New tests: endgame cap golden, Hard moon transition smoke, pruning/AB skip stress stay green.
- No regression in existing Normal/Hard goldens; CLI/docs reflect any new flags.
- Perf snapshots recorded in journal; typical decisions remain within target envelopes under caps.

Artifacts to add/update
- tests: `crates/hearts-app/tests/endgame_feed_cap_golden.rs`, `crates/hearts-app/tests/hard_moon_transition_smoke.rs`
- journal: update with results, seeds, bench snapshots, and links to CSV/JSON artifacts.