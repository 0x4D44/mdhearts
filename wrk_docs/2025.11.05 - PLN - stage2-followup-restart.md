# 2025.11.05 - Plan - Stage2 follow-up recovery

## Context
- Power cut on 2025-11-05 interrupted the Stage2 follow-up hardening pass after stabilising two new unit tests and converting trace flags to dynamic env reads.
- Snapshot coverage for seeds 1072/1066/1022 remains `#[ignore]` logging harnesses (`crates/hearts-app/tests/hard_stage2_snapshots.rs`).
- Manual eval workflow (`.github/workflows/eval.yml`) was added but last documented run predates the follow-up fixes.

## Immediate Steps
1. Re-run the repaired follow-up unit tests (`cargo test stage2_avoid_heavy_dump_after_moon_bust stage2_follow_limit_halts_simulation -- --nocapture`) with `MDH_TEST_TRACE_FOLLOWUP=1` to confirm traces and env cleanup post-power cut.
2. Replace the ignored snapshot tests with deterministic RoundState fixtures (clone the approach in `crates/hearts-app/tests/todo_stage1_stage2.rs`) so Stage2 seeds 1072/1066/1022 assert on planner choices instead of printing logs.
3. Expand Stage1 guard coverage by finishing the TODO suite (add feeds-gap + moon-gap cases) and ensure the helper env toggles reset after each test.
4. Refresh eval artifacts: run `tools/eval_all.sh 200` locally, update `designs/tuning/stage1/compare_release`, and, if stable, trigger the manual GitHub Eval workflow with bumped counts.
5. Document the rerun in `wrk_journals`, update `designs/2025.11.01 - Status - Continue-On-Main (Stage1+2).md`, then prep commits via `tools/commit_plan_on_main.sh` once tests + evals are green.
