# Plan: Improving SearchLookahead Performance

_Generated: 2025-11-07 12:25 CT_

## Objectives
1. Ensure Search gains measurable EV (penalty reduction) as think time increases (5s -> 10s -> 15s -> unlimited).
2. Improve Search’s mixed-seat competitiveness (especially north seat) without regressing Hard.
3. Deliver instrumentation + automation to prove the improvements.

## Stage 0 – Baseline Diagnostics
- [x] Instrument Search to log per-decision depth/budget usage vs. think limit.
- [x] Run targeted profiles (e.g., seats 1000-1100) at 5s/10s/15s/unlimited to identify where extra time isn’t translating to deeper search.
- [x] Compare Search telemetry with Hard to pinpoint bottlenecks (e.g., time wasted on pruning, deterministic branch cap).

## Stage 1 – Budget Scaling Enhancements
- [x] Introduce adaptive branch/continuation scaling tied to available think time (e.g., ramp branch_limit/top_k when limit >= 10s).
- [x] Add deterministic depth tiers (5s=baseline, 10s=+2 branches, 15s=+3 branches) with guardrails to avoid blow-ups.
- [x] Optionally add stochastic tie-breaking or transposition cache to leverage extra time more effectively.

## Stage 2 – Mixed-Seat Optimization
- [ ] Analyze mixed-seat telemetry to find seats where Search underperforms (north) and tune heuristics (e.g., pass priorities, endgame handling) for those positions.
- [ ] Consider seat-aware heuristics (lead sensitivity, moon threats) that unlock Search’s time advantage.

## Stage 3 – Automation & Proof
- [ ] Extend `tools/run_search_vs_hard.ps1` and `run_search_vs_mixed.ps1` to run comparison suites at multiple think limits automatically (Search vs Search with 5s vs 15s).
- [ ] Add analyzer scripts to compute delta in penalties vs. think time and output charts/tables.
- [ ] Integrate telemetry hooks showing how much extra work Search performs at higher limits (e.g., scanned nodes, depth).

## Stage 4 – Validation & Risk Mitigation
- [ ] Run long-form sweeps (e.g., 200 seeds per seat) to confirm Search improvements and ensure Hard regressions are absent.
- [ ] Update docs/README/Stage 5 report with new results; highlight evidence that higher think limits yield better Search outcomes.
- [ ] Prepare rollback switches (env flags) to disable new scaling if issues arise.

## Deliverables
- Enhanced Search planner (branch scaling, telemetry).
- Updated automation scripts + analyzer outputs proving think-time gains.
- Stage 6 report/PR documenting improvements and test coverage.
