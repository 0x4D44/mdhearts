# Spec: Mixed-Seat Search vs Hard Harness

_Generated: 2025-11-07 10:35 CT_

## Goals
- Automate mixed-seat evaluations (Search + Hard + optional Normal) without duplicating existing mirrored-seat script logic.
- Support multiple mixes per invocation (e.g., `shsh`, `sshh`, `snhh`), optional telemetry export, and deterministic smokes.
- Preserve the deterministic env defaults (Hard deterministic, fixed steps) while allowing overrides.

## Requirements
1. **CLI Coverage**
   - Commands: `--match-mixed` (inline seeds) and `--match-mixed-file` (seed file).
   - Flags: `--out`, `--stats`, `--telemetry-out`, shared think-limit + hard flags.
2. **Script Interface**
   - Add `tools/run_search_vs_mixed.ps1` (new file) with parameters:
     - `-Mixes @('shsh')`
     - `-SeatStarts` map (west/south/east/north) + per-mix override optional
     - `-Count 200` or per-mix counts
     - `-ThinkLimitsMs @(5000,0)` (optional)
     - `-SeedsFile <path>` to reuse saved seeds
     - `-TelemetrySmoke` switch (mirrors Stage 1 script behavior)
   - Shared helper module for ensure-dir, think-limit args, telemetry smoke.
3. **Outputs**
   - Folder structure: `designs/tuning/search_vs_mixed/<timestamp>/<mix>/<limit>/...`
   - Artifacts: match CSV per seat, telemetry NDJSON, summary.md capturing mix + penalties + timeout stats.
4. **Verification**
   - Include `-SmokeCount 5` default to run small deterministic sweep per mix before long runs.
   - Provide `Summarize-MixedMatch` helper to compute per-seat averages + disagreement counts (when `--stats` adds Hard telemetry columns).
5. **Docs**
   - Update README + CLI docs to mention `run_search_vs_mixed.ps1` and usage examples.
   - Add wrk_docs plan reference once implementation lands.

## Open Questions
- Should mixes rotate seats automatically (e.g., `shsh` but seat start rotates to cover Search at each position)?
- Do we need disagreement CSVs for mixed runs, or are stats columns enough?
- How to handle `--match-mixed-file` seed files across multiple mixes (one file per mix vs shared)?

## Next Actions
1. Extract shared helpers from `run_search_vs_hard.ps1` into `tools/lib_eval.ps1` (or similar) for reuse.
2. Scaffold new script with parameter parsing + folder creation.
3. Confirm CLI `--match-mixed` already respects `--telemetry-out`; add flag if missing.
4. Draft README/docs updates alongside script, then run initial 5-seed smoke for `shsh` mix.
